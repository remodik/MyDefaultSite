name: Update Wakatime Stats

on:
  schedule:
    - cron: '0 */1 * * *'

  workflow_dispatch:

jobs:
  update-stats:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download Wakatime stats
        run: |
          echo "ğŸ“¥ Downloading Wakatime stats..."
          curl -f -o wakatime-data.json \
            'https://wakatime.com/api/v1/users/remodik/stats/last_7_days' || exit 1

          echo "âœ… Downloaded successfully"
          cat wakatime-data.json

      - name: Commit and push changes
        run: |
          git config user.name "Wakatime Bot"
          git config user.email "wakatime-bot@users.noreply.github.com"

          git add wakatime-data.json

          if git diff --staged --quiet; then
            echo "ğŸ“ No changes to commit"
          else
            git commit -m "ğŸ¤– Update Wakatime stats"
            git push
            echo "âœ… Changes pushed to repository"
          fi
